## TODO: decide if we want to include this, as it will change the default behaviour of all pods with istio sidecars
##
################
## This ensures that Pods in only talk to each other through istio sidecars, cluster-wide,
## meaning all traffic obeys Istio AuthorizationPolicy configs.
################
#apiVersion: security.istio.io/v1beta1
#kind: PeerAuthentication
#metadata:
#  name: kubeflow-auth--default-mtls
#  ## NOTE: this is in the root istio namespace, so that it can select pods across all namespaces
#  namespace: {{ .Values.argoflow.istio.namespace | quote }}
#  labels:
#    helm.sh/chart: {{ include "kubeflow-auth.labels.chart" . }}
#    app.kubernetes.io/name: {{ include "kubeflow-auth.labels.name" . }}
#    app.kubernetes.io/instance: {{ .Release.Name }}
#    app.kubernetes.io/managed-by: {{ .Release.Service }}
#    app.kubernetes.io/component: cluster-istio-configs
#spec:
#  mtls:
#    ## TODO: test with PERMISSIVE to see if "non-mesh Pod" or "non K8S system" can bypass our AuthorizationPolicy
#    mode: STRICT