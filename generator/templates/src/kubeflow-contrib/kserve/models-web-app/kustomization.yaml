apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

## global namespace must be set due to:
## https://github.com/kubernetes-sigs/kustomize/issues/1301#issuecomment-1308228710
namespace: kubeflow

resources:
  ## NOTE: this points to the `kserve/models-web-app` repo, not the `kubeflow/manifests` (because it's a contrib app)
  - github.com/kserve/models-web-app/config/overlays/kubeflow?ref=2919e71c2bff928c51393c6cd643cb62f7c2f1b2 # tag=v0.8.1

patchesStrategicMerge:
  - patches/patch-kserve-models-web-app-authorizationpolicy.yaml
  - patches/patch-kserve-models-web-app-virtualservice.yaml

configMapGenerator:
  - name: kserve-models-web-app-config
    behavior: merge
    literals:
      ## TODO: what should `APP_DISABLE_AUTH` be set to?
      - APP_DISABLE_AUTH="True"
      - APP_PREFIX="/kserve-endpoints"
      - APP_SECURE_COOKIES="True"
      - CSRF_SAMESITE="Strict"
      - USERID_HEADER="kubeflow-userid"
      - USERID_PREFIX=""

images:
  - name: kserve/models-web-app
    newName: kserve/models-web-app
    newTag: v0.8.0
