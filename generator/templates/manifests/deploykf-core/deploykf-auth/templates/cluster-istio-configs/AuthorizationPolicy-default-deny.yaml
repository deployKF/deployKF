## TODO: decide if we want to include this, as it will change the default behaviour of all pods with istio sidecars
##
################
## This enforces a deny-by-default authorization model that is different from Istio's default behaviour.
## Meaning a Pod with an Istio sidecar and no matching AuthorizationPolicy, will have no traffic allowed to reach it.
## It achieves this by selecting literally all Pods in the cluster, meaning all Pods will at least match this policy,
## so Istio's fallback ALLOW (for when no policies match) will not trigger.
################
#apiVersion: security.istio.io/v1beta1
#kind: AuthorizationPolicy
#metadata:
#  name: deploykf-auth--default-deny
#  ## NOTE: this is in the root istio namespace, so that it can select pods across all namespaces
#  namespace: {{ .Values.deployKF.istio.namespace | quote }}
#  labels:
#    helm.sh/chart: {{ include "deploykf-auth.labels.chart" . }}
#    app.kubernetes.io/name: {{ include "deploykf-auth.labels.name" . }}
#    app.kubernetes.io/instance: {{ .Release.Name }}
#    app.kubernetes.io/managed-by: {{ .Release.Service }}
#    app.kubernetes.io/component: cluster-istio-configs
#spec: {}
